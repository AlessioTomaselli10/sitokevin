---
const links = [
  { href: "/", label: "Home" },
  { href: "/consulenza", label: "Consulenza" },
  // Aggiungi qui altre pagine quando saranno pronte
];
---

<header class="flex items-center justify-between px-6 py-4 text-[color:rgba(30,58,95,0.85)] font-alt">
  <!-- Logo -->
  <a href="/" class="block">
    <img src="/images/logo.svg" alt="Logo Kevin Fazzelli" class="h-20 w-auto -ml-[1vw]" loading="eager" />
  </a>

  <!-- Hamburger - SEMPRE VISIBILE -->
  <button id="hamburger" class="flex flex-col gap-1.5 group" aria-label="Apri menu">
    <span class="h-[3px] w-6 bg-blue-900/85 group-hover:bg-blue-900 transition-colors"></span>
    <span class="h-[3px] w-6 bg-blue-900/85 group-hover:bg-blue-900 transition-colors"></span>
    <span class="h-[3px] w-6 bg-blue-900/85 group-hover:bg-blue-900 transition-colors"></span>
  </button>
</header>

<!-- Overlay -->
<div id="overlay" class="fixed inset-0 bg-black/40 hidden z-[998] transition-opacity duration-300"></div>

<!-- Menu a tendina - SEMPRE LO STESSO -->
<aside id="mobileMenu" class="fixed top-0 right-0 h-screen w-[250px] bg-blue-900 text-white p-6 hidden z-[999] translate-x-full transition-transform duration-300">
  <button id="closeMenu" class="ml-auto mb-6 text-3xl font-bold leading-none transition-transform duration-300" aria-label="Chiudi menu">&times;</button>
  <nav class="flex flex-col gap-5">
    {links.map((l) => (
      <a href={l.href} class="text-white text-lg hover:text-blue-200 transition-colors duration-200">{l.label}</a>
    ))}
  </nav>
</aside>

<script is:inline>
  const hamburger = document.getElementById('hamburger');
  const overlay = document.getElementById('overlay');
  const mobileMenu = document.getElementById('mobileMenu');
  const closeBtn = document.getElementById('closeMenu');

  function openMenu() {
    mobileMenu.classList.remove('hidden');
    overlay.classList.remove('hidden');
    // Forza il reflow per attivare la transizione
    void mobileMenu.offsetWidth;
    // Rimuovi translate-x-full per far scivolare il menu
    mobileMenu.classList.remove('translate-x-full');
    
    closeBtn?.classList.remove('rotate-90');
    requestAnimationFrame(() => closeBtn?.classList.add('rotate-90'));
  }

  function closeMenu() {
    mobileMenu.classList.add('translate-x-full');
    overlay.classList.add('hidden');
    closeBtn?.classList.remove('rotate-90');
    
    // Nascondi il menu dopo la transizione
    setTimeout(() => {
      mobileMenu.classList.add('hidden');
    }, 300);
  }

  hamburger?.addEventListener('click', openMenu);
  overlay?.addEventListener('click', closeMenu);
  closeBtn?.addEventListener('click', closeMenu);

  // Chiudi il menu quando si clicca su un link
  document.querySelectorAll('#mobileMenu a').forEach(link => {
    link.addEventListener('click', closeMenu);
  });

  // Chiudi il menu con il tasto ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && !mobileMenu.classList.contains('hidden')) {
      closeMenu();
    }
  });
</script>